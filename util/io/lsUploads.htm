<!doctype html><html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, user-scalable=yes, minimum-scale=1.0, maximum-scale=10.0">
<style>
button { margin:2px; }
</style>
</head>
<body bgcolor="#aaaaaa" style="font-family:sans-serif;box-sizing:border-box;">
<h1>LocalStorage Uploads</h1>
V.0.1 <b>Following files were uploaded to localStorage:</b>
<script type="text/javascript">
(function() {
  //--
  let s=localStorage['conet2index'];
  if (!s) return;
  let d=JSON.parse(s);
  for (let fn of Object.keys(d)) {
    let c=document.createElement('div');
    let fdata=localStorage['conet2d'+fn];
    
    let b;
    b=document.createElement('button');
    b.innerHTML='Import';
  b.onclick=function() {
    //---
    //onsole.log('import fn='+fn+' data='+ta.value);
    localStorage['conet2d'+fn]=ta.value;
    console.log('import done, fn='+fn+' '+ta.value.length+'chars');
    //...
  }
    c.appendChild(b);
    
    
    b=document.createElement('button');
    b.innerHTML='Share';
  b.onclick=function() {
    //---
    //alert(fn);
    async function share() {
      //---
      try {
        await navigator.share({title:fn,text:fdata});
        console.log('share success');
      } catch (err) {
        console.log(`Error: ${err}`);
      }
      //...
    }
    
    share();
    //...
  }
    c.appendChild(b);
    
    b=document.createElement('button');
    b.innerHTML='Delete';
  b.onclick=function() {
    //---
    localStorage.removeItem('conet2d'+fn);
    delete(d[fn]);
    localStorage['conet2index']=JSON.stringify(d);
    window.location.reload();
    //...
  }
    c.appendChild(b);
    
    
    c.appendChild(document.createTextNode(fn+' '+JSON.stringify(d[fn])+' '+fdata.length+'b'));
    //d[fn].data=fdata; //needed for alldata but problematic in delete, dont bloat d
    document.body.appendChild(c);
  
    c=document.createElement('div');
    c.style.paddingRight='5px';
    let ta=document.createElement('textarea');
    ta.style.width='100%';
    ta.style.height='100px';
    ta.value=fdata;
    c.appendChild(ta);
    document.body.appendChild(c);
  }
  //onsole.log(d);
  if (0) { 
  let c=document.createElement('div');
  c.style.marginTop='10px';
  let alldata=JSON.stringify({what:'lsUploads',files:d});
  c.appendChild(document.createTextNode('Everything '+alldata.length+'b'));
  document.body.appendChild(c);
  
  c=document.createElement('div');
  c.style.paddingRight='5px';
  let ta=document.createElement('textarea');
  ta.style.width='100%';
  ta.style.height='200px';
  ta.value=alldata;
  c.appendChild(ta);
  document.body.appendChild(c);
  }
  //...
}
)();
</script>

</body>
</html><script>
//fr o,11
//fr o,11,11
//fr o,11,17
//fr o,11,17,2
//fr o,11,22
//fr p,2,25
